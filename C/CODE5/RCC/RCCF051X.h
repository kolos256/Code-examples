#if (!defined(_RCCF051_H_))
#define _RCCF051_H_

#include "CORE\CORE.h"
#ifdef USECONF
#include "CONF.h"
#include "devlist.h"
#endif//USECONF

#if defined(STM32F051X)
typedef struct
{
  union
  {
    U32 VALUE;
    struct
    {
      U32 HSION:1,HSIRDY:1,:1,HSITRIM:5,HSICAL:8,HSEON:1,HSERDY:1,HSEBYP:1,CSSON:1,:4,PLLON:1,PLLRDY:1;
    }BIT;
  }CR;
  
  union
  {
    U32 VALUE;
    struct
    {
      U32 SW:2,SWS:2,HPRE:4,PPRE:3,:3,ADCPRE:1,:1,PLLSRC:1,PLLXTPRE:1,PLLMUL:4,:2,MCO:2 ;
    }BIT;
  }CFGR;
  
  union
  {
    U32 VALUE;
    struct
    {
      U32 LSIRDYF:1,LSERDYF:1,HSIRDYF:1,HSERDYF:1,PLLRDYF:1,HSI14RDYF:1,:1,CSSF:1,LSIRDYIE:1,LSERDYIE:1,HSIRDYIE:1,HSERDYIE:1,PLLRDYIE:1,HSI14RDYIE:1,:2,LSIRDYC:1,LSERDYC:1,HSIRDYC:1,HSERDYC:1,PLLRDYC:1,HSI14RDYC:1,:1,CSSC:1;
    }BIT;
  }CIR;
  
  union
  {
    U32 VALUE;
    struct
    {
      U32 SYSCFGCOMPRST:1,:8,ADCRST:1,:1,TIM1RST:1,SPI1RST:1,:1,USART1RST:1,:1,TIM15RST:1,TIM16RST:1,TIM17RST:1,:3,DBG_MCURST:1;
    }BIT;
  }APB2RSTR;
  
  union
  {
    U32 VALUE;
    struct
    {
      U32 TIM2RST:1,TIM3RST:1,:2,TIM6RST:1,:3,TIM14RST:1,:2,WWDGRST:1,:2,SPI2RST:1,:2,USART2RST:1,:3,I2C1RST:1,I2C2RST:1,:5,PWRRST:1,DACRST:1,CECRST:1;
    }BIT;
  }APB1RSTR;
  
  union
  {
    U32 VALUE;
    struct
    {
      U32 DMAEN:1,:1,SRAMN:1,:1,FLITFEN:1,:1,CRCEN:1,:10,IOPAEN:1,IOPBEN:1,IOPCEN:1,IOPDEN:1,:1,IOPFEN:1,:1,TSCEN:1;
    }BIT;
  }AHBENR;
  
  union
  {
    U32 VALUE;
    struct
    {
      U32 SYSCFGCOMPEN:1,:8,ADCEN:1,:1,TIM1EN:1,SPI1EN:1,:1,USART1EN:1,:1,TIM15EN:1,TIM16EN:1,TIM17EN:1,:3,DBG_MCUEN:1;
    }BIT;
  }APB2ENR;
  
  union
  {
    U32 VALUE;
    struct
    {
      U32 TIM2EN:1,TIM3EN:1,:2,TIM6EN:1,:3,TIM14EN:1,:2,WWDGEN:1,:2,SPI2EN:1,:2,USART2EN:1,:3,I2C1EN:1,I2C2EN:1,:5,PWREN:1,DACEN:1,CECEN:1;
    }BIT;
  }APB1ENR;
  
  union
  {
    U32 VALUE;
    struct
    {
      U32 LSEON:1,LSERDY:1,LSEBYP:1,LSEDRV:2,:3,RTCSEL:2,:5,RTCEN:1,BDRST:1;
    }BIT;
  }BDCR;
  
  
  union
  {
    U32 VALUE;
    struct
    {
      U32 LSION:1,LSIRDY:1,:21,PORV18RSTF:1,RMVF:1,OBLRSTF:1,PINRSTF:1,PORRSTF:1,SFTRSTF:1,IWDGRSTF:1,WWDGRSTF:1,LPWRRSTF:1;
    }BIT;
  }CSR;
  
  union
  {
    U32 VALUE;
    struct
    {
      U32 :17,IOPAEN:1,IOPBEN:1,IOPCEN:1,IOPDEN:1,:1,IOPFEN:1,:1,TSCEN:1;
    }BIT;
  }AHBRSTR;
  
  union
  {
    U32 VALUE;
    struct
    {
      U32 PREDIV:4;
    }BIT;
  }CFGR2;
  
  union
  {
    U32 VALUE;
    struct
    {
      U32 USART1SW:2,:2,I2C1SW:1,:1,ADCSW:1;
    }BIT;
  }CFGR3;
  
  union
  {
    U32 VALUE;
    struct
    {
      U32 HSI14ON:1,HSI14RDY:1,HSI14DIS:1,HSI14TRIM:5,HSI14CAL:8;
    }BIT;
  }CR2;
}RCC_BYTES;

#define RCC (*((RCC_BYTES*)RCC_BASE))


typedef enum
{
	ADCHSI14=0x00000000,
    ADCHSIPLCK=0x00000100,
    CECHSIDIV224=0x00000000,
    CECLSE=0x00000040,
    I2C1HSI=0x00000000,
    I2C1SYSCLK=0x00000010,
    USART1PCLK=0x00000000,
    USART1SYSCLK=0x00000001,
    USART1LSE=0x00000002,
    USART1HSI=0x00000003
}CLKSRC;

extern void SETCLKSOURCE(CLKSRC SRC);

typedef enum {PLLHSIDIV2SRC=0,PLLHSESRC=1}PLL_SRC;

extern void MAINPLLINIT(PLL_SRC SRC,U16 PLLMUL);
extern CMDRES PLLCMD(U16 TIMEOUT,State CMD);
extern CMDRES HSICMD(U16 TIMEOUT,State CMD);
extern CMDRES HSI14CMD(U16 TIMEOUT,State CMD);

typedef enum {APB_DIV1=0,APB_DIV2=4,APB_DIV4=5,APB_DIV8=6,APB_DIV16=7}APB_DIV;
typedef enum {AHB_DIV1=0,AHB_DIV2=8,AHB_DIV4=9,AHB_DIV8=10,AHB_DIV16=11,AHB_DIV64=12,AHB_DIV128=13,AHB_DIV256=14,AHB_DIV512=15}AHB_DIV;

extern void APBAHBDIV(APB_DIV APB,AHB_DIV AHB);

typedef enum {HSISRC=0,HSESRC=1,PLLSRC=2,HSI48SRC=3}SYSSRC;

extern CMDRES SYSCLKSW(SYSSRC SOURSE,U16 TIMEOUT);

#endif//defined(STM32F051X)

#endif//defined(_RCCF051_H_)
